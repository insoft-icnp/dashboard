{"description":"This dashboard uses the metrics sent using `k8sclusterreceiver` to show the desired and currently running pods for deployments, daemonsets, statefulset, replicasets and pods count by phase.","image":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHZpZXdCb3g9IjAgMCAxOCAxOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE0Ljk0OTQgMTMuOTQyQzE2LjIzMTggMTIuNDI1OCAxNy4zMjY4IDkuNzAyMiAxNi4xOTU2IDYuNTc0ODdDMTUuNjQ0MyA1LjA1MjQ1IDE1LjAyMTkgNC4yMDI0OSAxNC4yOTY5IDMuNjYyNTJDMTMuODU1NyAzLjMzMzc5IDEyLjA5MzMgMi41MDYzMyA5Ljc1OTY1IDIuODY3NTZDOC4wNTM0OSAzLjEzMjU1IDUuNzc0ODcgNC4yMDg3NCA0LjI5MzY5IDUuOTU5OUMyLjg1NzUyIDcuNjYxMDYgMS43NDg4MyA5LjAwNDc0IDEuNjk3NTggMTAuMzA5N0MxLjYzMTMzIDExLjk4ODMgMi44OTYyNyAxMy40MzA4IDMuMDUwMDEgMTMuNjY0NUMzLjMyMzc0IDE0LjA3OTUgNS4xOTExNSAxNi40NTE4IDguNjk5NzEgMTYuNTczMUMxMS43OTcgMTYuNjc5MyAxMy44MTQ0IDE1LjI4NDQgMTQuOTQ5NCAxMy45NDJaIiBmaWxsPSIjNDAzRDNFIi8+CjxwYXRoIGQ9Ik00LjU1MzYzIDIuNzM3NDdDMi45Mzc0NiAzLjg5MTE2IDEuMTIxMzEgNi4yNTEwMyAxLjQ0NzU0IDkuNTYwODZDMS42MDYyOCAxMS4xNzIgMi4wMDI1MSAxMi4xNDk1IDIuNTcxMjMgMTIuODUwN0MyLjkxNzQ2IDEzLjI3ODIgNC40MTk4OCAxNC41NDkzIDYuNzczNTEgMTQuNzM2OEM5LjE0NTg4IDE0LjkyNTYgMTAuOTQ5NSAxNC4zOTQ0IDEyLjgzMzIgMTMuMDg0NEMxNi42NjE3IDEwLjQyMDggMTYuMDk4IDYuMzkzNTMgMTUuOTM0MyA1LjkyNDhDMTUuNzcwNSA1LjQ1NjA3IDE0LjU0NDQgMi42OTYyMiAxMS4xNzMzIDEuNzE1MDJDOC4xOTg0NCAwLjg1MDA2OCA1Ljk4MzU1IDEuNzE1MDIgNC41NTM2MyAyLjczNzQ3WiIgZmlsbD0iIzVFNjM2NyIvPgo8cGF0aCBkPSJNNy4zOTM1MyAyLjk2MTA5QzUuNjE3MzcgMi44OTczNCAzLjkxOTk2IDQuMjg4NTIgMy43NTYyMiA2LjAwNTkzQzMuNTkyNDggNy43MjIwOSA0LjY1NDkyIDkuMDI5NTIgNi4zMDk4MyA5LjI5NTc2QzcuOTY0NzUgOS41NjA3NCA5Ljg3ODM5IDguNTU1OCAxMC4yNjM0IDYuNDUwOTFDMTAuNjYwOSA0LjI4MjI3IDkuMDg5NjkgMy4wMjIzNCA3LjM5MzUzIDIuOTYxMDlaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNy45NDIxNyA1LjkwMTE1QzcuOTQyMTcgNS45MDExNSA4LjM2OTY1IDUuODEyNCA4LjQ1NDY1IDUuMTgyNDRDOC41MzgzOSA0LjU2MjQ3IDguMjMwOTEgNC4wMzM3NSA3LjUxMzQ1IDMuODQzNzZDNi43MzM0OSAzLjYzNzUyIDYuMjA0NzcgNC4wNjYyNSA2LjA2NzI3IDQuNTE3NDdDNS44NzYwMyA1LjE0NDk0IDYuMTU4NTIgNS40NDM2NyA2LjE1ODUyIDUuNDQzNjdDNi4xNTg1MiA1LjQ0MzY3IDUuMzkzNTYgNS42Mjc0MSA1LjMzMjMxIDYuNTI5ODdDNS4yNzQ4MSA3LjM4MTA3IDUuODU2MDMgNy44Mzg1NSA2LjQzOTc1IDcuOTc4NTRDNy4xNjA5NiA4LjE1MjI4IDcuOTc4NDIgNy45NTQ3OSA4LjE3ODQxIDcuMDM0ODRDOC4zNDQ2NSA2LjI3NzM4IDcuOTQyMTcgNS45MDExNSA3Ljk0MjE3IDUuOTAxMTVaIiBmaWxsPSIjMzAzMDMwIi8+CjxwYXRoIGQ9Ik02LjczOTgzIDQuNzUzNjJDNi42NzEwOSA1LjAxMjM1IDYuODA4NTggNS4yNjIzNCA3LjA3ODU3IDUuMzMxMDlDNy4zNjk4IDUuNDA0ODMgNy42MzQ3OSA1LjMwODU5IDcuNzA2MDMgNS4wMTExQzcuNzY4NTMgNC43NDczNyA3LjY0MzU0IDQuNTE0ODggNy4zMzYwNSA0LjQzOTg4QzcuMDgzNTcgNC4zNzczOSA2LjgxNDgzIDQuNDcxMTMgNi43Mzk4MyA0Ljc1MzYyWiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTYuOTU5NzggNi4wMzk3NEM2LjYzMjMgNS45Mzg0OSA2LjE5OTgyIDYuMDY0NzMgNi4xMzEwNyA2LjUwNDcxQzYuMDYyMzMgNi45NDQ2OSA2LjMyNjA2IDcuMTY5NjggNi42NzEwNCA3LjIzMjE3QzcuMDE2MDMgNy4yOTQ2NyA3LjM0MjI2IDcuMTEzNDMgNy40MDYwMSA2Ljc2MDk1QzcuNDY4NSA2LjQwOTcyIDcuMjg2MDEgNi4xMzk3MyA2Ljk1OTc4IDYuMDM5NzRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K","layout":[{"h":11,"i":"7c4b1efb-8b3a-4a28-927d-f7fe9fb124e8","moved":false,"static":false,"w":12,"x":0,"y":0},{"h":11,"i":"cac6085f-b603-48fb-9094-61c7eedd3b1f","moved":false,"static":false,"w":12,"x":0,"y":11},{"h":7,"i":"50a86ebc-f028-44bf-93f4-a62cc0ba8dd9","moved":false,"static":false,"w":6,"x":0,"y":22},{"h":7,"i":"889f2919-d0d7-4eab-8f83-3a51fa11bf41","moved":false,"static":false,"w":6,"x":6,"y":22},{"h":7,"i":"f4c5050e-fcb8-46f7-88b7-e8f13c8d6fdd","moved":false,"static":false,"w":6,"x":0,"y":29},{"h":7,"i":"e87e271c-727b-4ae1-8d11-609a1ffaa31d","moved":false,"static":false,"w":6,"x":6,"y":29}],"panelMap":{},"tags":["k8s","cluster","k8sclusterreceiver"],"title":"Kubernetes cluster metrics","uploadedGrafana":false,"variables":{"3ec0c79e-1191-4946-acf9-1c4e9b946a58":{"allSelected":true,"customValue":"","description":"The k8s namespace name.\t","id":"3ec0c79e-1191-4946-acf9-1c4e9b946a58","key":"3ec0c79e-1191-4946-acf9-1c4e9b946a58","modificationUUID":"34a479ac-fed2-4775-8369-2a0e85af3d19","multiSelect":true,"name":"k8s_namespace_name","order":1,"queryValue":"SELECT JSONExtractString(labels, 'k8s_namespace_name') AS k8s_namespace_name\nFROM om_metrics.distributed_time_series_v4_1day\nWHERE metric_name = 'k8s_container_ready' AND JSONExtractString(labels, 'k8s_cluster_name') IN ({{.k8s_cluster_name}})\nGROUP BY k8s_namespace_name\n","showALLOption":true,"sort":"ASC","textboxValue":"","type":"QUERY"},"ed181275-0355-4f6d-b1b7-ba4d76347120":{"allSelected":false,"customValue":"","description":"Name of the cluster","id":"ed181275-0355-4f6d-b1b7-ba4d76347120","modificationUUID":"d3e4bd31-bf8c-4c11-9c25-df6d41dd04b1","multiSelect":true,"name":"k8s_cluster_name","order":0,"queryValue":"SELECT JSONExtractString(labels, 'k8s_cluster_name') AS k8s_cluster_name\nFROM om_metrics.distributed_time_series_v4_1day\nWHERE metric_name = 'k8s_container_ready'\nGROUP BY k8s_cluster_name","showALLOption":true,"sort":"DISABLED","textboxValue":"","type":"QUERY"}},"version":"v4","widgets":[{"bucketCount":30,"bucketWidth":0,"columnUnits":{},"description":"","fillSpans":false,"id":"50a86ebc-f028-44bf-93f4-a62cc0ba8dd9","isStacked":false,"mergeAllActiveQueries":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"table","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"float64","id":"k8s_deployment_available--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_deployment_available","type":"Gauge"},"aggregateOperator":"latest","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[{"id":"4b220506","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"c75c7eaf","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_deployment_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_deployment_name","type":"tag"}],"having":[],"legend":"available","limit":null,"orderBy":[],"queryName":"A","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"latest"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_deployment_desired--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_deployment_desired","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"B","filters":{"items":[{"id":"7b5eaf04","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"8d82e1c8","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_deployment_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_deployment_name","type":"tag"}],"having":[],"legend":"desired","limit":null,"orderBy":[],"queryName":"B","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"avg"}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"2243209b-1209-4a04-8f5d-ae481f5731f3","promql":[{"disabled":false,"legend":"","name":"A","query":""}],"queryType":"builder"},"selectedLogFields":[{"dataType":"string","name":"body","type":""},{"dataType":"string","name":"timestamp","type":""}],"selectedTracesFields":[{"dataType":"string","id":"serviceName--string--tag--true","isColumn":true,"isJSON":false,"key":"serviceName","type":"tag"},{"dataType":"string","id":"name--string--tag--true","isColumn":true,"isJSON":false,"key":"name","type":"tag"},{"dataType":"float64","id":"durationNano--float64--tag--true","isColumn":true,"isJSON":false,"key":"durationNano","type":"tag"},{"dataType":"string","id":"httpMethod--string--tag--true","isColumn":true,"isJSON":false,"key":"httpMethod","type":"tag"},{"dataType":"string","id":"responseStatusCode--string--tag--true","isColumn":true,"isJSON":false,"key":"responseStatusCode","type":"tag"}],"softMax":0,"softMin":0,"stackedBarChart":false,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Deployments available and desired","yAxisUnit":"none"},{"bucketCount":30,"bucketWidth":0,"columnUnits":{},"description":"","fillSpans":false,"id":"f4c5050e-fcb8-46f7-88b7-e8f13c8d6fdd","isStacked":false,"mergeAllActiveQueries":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"table","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"float64","id":"k8s_daemonset_current_scheduled_nodes--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_daemonset_current_scheduled_nodes","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[{"id":"4726c628","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"f2c84d43","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_daemonset_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_daemonset_name","type":"tag"}],"having":[],"legend":"current_nodes","limit":null,"orderBy":[],"queryName":"A","reduceTo":"last","spaceAggregation":"avg","stepInterval":60,"timeAggregation":"avg"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_daemonset_desired_scheduled_nodes--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_daemonset_desired_scheduled_nodes","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"B","filters":{"items":[{"id":"e0bd05b0","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"086d6720","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_daemonset_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_daemonset_name","type":"tag"}],"having":[],"legend":"desired_nodes","limit":null,"orderBy":[],"queryName":"B","reduceTo":"last","spaceAggregation":"avg","stepInterval":60,"timeAggregation":"avg"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_daemonset_ready_nodes--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_daemonset_ready_nodes","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"C","filters":{"items":[{"id":"48ed5161","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"30b09ce3","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_daemonset_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_daemonset_name","type":"tag"}],"having":[],"legend":"ready_nodes","limit":null,"orderBy":[],"queryName":"C","reduceTo":"last","spaceAggregation":"avg","stepInterval":60,"timeAggregation":"avg"}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"4a521066-a0ad-4989-a3af-c923a7e59854","promql":[{"disabled":false,"legend":"","name":"A","query":""}],"queryType":"builder"},"selectedLogFields":[{"dataType":"string","name":"body","type":""},{"dataType":"string","name":"timestamp","type":""}],"selectedTracesFields":[{"dataType":"string","id":"serviceName--string--tag--true","isColumn":true,"isJSON":false,"key":"serviceName","type":"tag"},{"dataType":"string","id":"name--string--tag--true","isColumn":true,"isJSON":false,"key":"name","type":"tag"},{"dataType":"float64","id":"durationNano--float64--tag--true","isColumn":true,"isJSON":false,"key":"durationNano","type":"tag"},{"dataType":"string","id":"httpMethod--string--tag--true","isColumn":true,"isJSON":false,"key":"httpMethod","type":"tag"},{"dataType":"string","id":"responseStatusCode--string--tag--true","isColumn":true,"isJSON":false,"key":"responseStatusCode","type":"tag"}],"softMax":0,"softMin":0,"stackedBarChart":false,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Daemonset nodes","yAxisUnit":"none"},{"bucketCount":30,"bucketWidth":0,"columnUnits":{},"description":"","fillSpans":false,"id":"cac6085f-b603-48fb-9094-61c7eedd3b1f","isStacked":false,"mergeAllActiveQueries":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"table","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"float64","id":"k8s_hpa_current_replicas--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_hpa_current_replicas","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[{"id":"fb73dfa9","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"6f619a64","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_hpa_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_hpa_name","type":"tag"}],"having":[],"legend":"current_replicas","limit":null,"orderBy":[],"queryName":"A","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"avg"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_hpa_desired_replicas--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_hpa_desired_replicas","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"B","filters":{"items":[{"id":"d16e50c7","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"2e48ee3a","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_hpa_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_hpa_name","type":"tag"}],"having":[],"legend":"desired_replicas","limit":null,"orderBy":[],"queryName":"B","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"avg"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_hpa_min_replicas--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_hpa_min_replicas","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"C","filters":{"items":[{"id":"008dd9a1","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"a120c41b","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_hpa_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_hpa_name","type":"tag"}],"having":[],"legend":"min_replicas","limit":null,"orderBy":[],"queryName":"C","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"avg"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_hpa_max_replicas--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_hpa_max_replicas","type":"Gauge"},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"D","filters":{"items":[{"id":"458a9154","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"4dbe1ea2","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_hpa_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_hpa_name","type":"tag"}],"having":[],"legend":"max_replicas","limit":null,"orderBy":[],"queryName":"D","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"avg"}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"28e19e4f-ea66-4a83-be48-64492709df77","promql":[{"disabled":false,"legend":"","name":"A","query":""}],"queryType":"builder"},"selectedLogFields":[{"dataType":"string","name":"body","type":""},{"dataType":"string","name":"timestamp","type":""}],"selectedTracesFields":[{"dataType":"string","id":"serviceName--string--tag--true","isColumn":true,"isJSON":false,"key":"serviceName","type":"tag"},{"dataType":"string","id":"name--string--tag--true","isColumn":true,"isJSON":false,"key":"name","type":"tag"},{"dataType":"float64","id":"durationNano--float64--tag--true","isColumn":true,"isJSON":false,"key":"durationNano","type":"tag"},{"dataType":"string","id":"httpMethod--string--tag--true","isColumn":true,"isJSON":false,"key":"httpMethod","type":"tag"},{"dataType":"string","id":"responseStatusCode--string--tag--true","isColumn":true,"isJSON":false,"key":"responseStatusCode","type":"tag"}],"softMax":0,"softMin":0,"stackedBarChart":false,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Pod replicas","yAxisUnit":"none"},{"bucketCount":30,"bucketWidth":0,"columnUnits":{},"description":"","fillSpans":false,"id":"889f2919-d0d7-4eab-8f83-3a51fa11bf41","isStacked":false,"mergeAllActiveQueries":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"table","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"float64","id":"k8s_job_active_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_job_active_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[{"id":"3ebdd2a3","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"868b94ff","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_job_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_job_name","type":"tag"}],"having":[],"legend":"running","limit":null,"orderBy":[],"queryName":"A","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_job_successful_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_job_successful_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"B","filters":{"items":[{"id":"48a1e5f4","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"b84148d2","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_job_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_job_name","type":"tag"}],"having":[],"legend":"successful","limit":null,"orderBy":[],"queryName":"B","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_job_failed_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_job_failed_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"C","filters":{"items":[{"id":"d6a91ea6","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"43a1a1c8","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_job_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_job_name","type":"tag"}],"having":[],"legend":"failed","limit":null,"orderBy":[],"queryName":"C","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_job_desired_successful_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_job_desired_successful_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"D","filters":{"items":[{"id":"74536e2d","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"f2f02884","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_job_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_job_name","type":"tag"}],"having":[],"legend":"desired successful","limit":null,"orderBy":[],"queryName":"D","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"2afee322-d310-44ce-9a73-1a2272d184c7","promql":[{"disabled":false,"legend":"","name":"A","query":""}],"queryType":"builder"},"selectedLogFields":[{"dataType":"string","name":"body","type":""},{"dataType":"string","name":"timestamp","type":""}],"selectedTracesFields":[{"dataType":"string","id":"serviceName--string--tag--true","isColumn":true,"isJSON":false,"key":"serviceName","type":"tag"},{"dataType":"string","id":"name--string--tag--true","isColumn":true,"isJSON":false,"key":"name","type":"tag"},{"dataType":"float64","id":"durationNano--float64--tag--true","isColumn":true,"isJSON":false,"key":"durationNano","type":"tag"},{"dataType":"string","id":"httpMethod--string--tag--true","isColumn":true,"isJSON":false,"key":"httpMethod","type":"tag"},{"dataType":"string","id":"responseStatusCode--string--tag--true","isColumn":true,"isJSON":false,"key":"responseStatusCode","type":"tag"}],"softMax":0,"softMin":0,"stackedBarChart":false,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Jobs","yAxisUnit":"none"},{"bucketCount":30,"bucketWidth":0,"columnUnits":{},"description":"","fillSpans":false,"id":"7c4b1efb-8b3a-4a28-927d-f7fe9fb124e8","isStacked":false,"mergeAllActiveQueries":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"table","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"isJSON":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"functions":[],"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"avg","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"rate"}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":"SELECT\n    k8s_namespace_name,\n    countIf(last_phase = 1) AS Pending,\n    countIf(last_phase = 2) AS Running,\n    countIf(last_phase = 3) AS Succeeded,\n    countIf(last_phase = 4) AS Failed,\n    countIf(last_phase = 5) AS Unknown\nFROM\n(\n    SELECT\n        k8s_pod_name,\n        k8s_namespace_name,\n        now() AS ts,\n        anyLast(value) AS last_phase\n    FROM om_metrics.distributed_samples_v4\n    INNER JOIN\n    (\n        SELECT DISTINCT\n            JSONExtractString(labels, 'k8s_pod_name') AS k8s_pod_name,\n            JSONExtractString(labels, 'k8s_namespace_name') AS k8s_namespace_name,\n            JSONExtractString(labels, 'k8s_cluster_name') AS k8s_cluster_name,\n            fingerprint\n        FROM om_metrics.time_series_v4_1day\n        WHERE (metric_name = 'k8s_pod_phase') \n        AND (temporality = 'Unspecified') \n        AND JSONExtractString(labels, 'k8s_cluster_name') IN {{.k8s_cluster_name}}\n        AND JSONExtractString(labels, 'k8s_namespace_name') IN {{.k8s_namespace_name}}\n    ) AS filtered_time_series USING (fingerprint)\n    WHERE (metric_name = 'k8s_pod_phase') \n    AND (unix_milli >= {{.start_timestamp_ms}}) \n    AND (unix_milli < {{.end_timestamp_ms}})\n    GROUP BY\n        k8s_pod_name,\n        k8s_namespace_name,\n        ts\n    ORDER BY\n        k8s_namespace_name ASC,\n        k8s_pod_name ASC,\n        ts ASC\n)\nGROUP BY k8s_namespace_name\nORDER BY Running DESC;\n"}],"id":"2861fcd7-a8a2-4b6b-b4a8-d0361f5b0c1a","promql":[{"disabled":false,"legend":"","name":"A","query":""}],"queryType":"clickhouse_sql"},"selectedLogFields":[{"dataType":"string","name":"body","type":""},{"dataType":"string","name":"timestamp","type":""}],"selectedTracesFields":[{"dataType":"string","id":"serviceName--string--tag--true","isColumn":true,"isJSON":false,"key":"serviceName","type":"tag"},{"dataType":"string","id":"name--string--tag--true","isColumn":true,"isJSON":false,"key":"name","type":"tag"},{"dataType":"float64","id":"durationNano--float64--tag--true","isColumn":true,"isJSON":false,"key":"durationNano","type":"tag"},{"dataType":"string","id":"httpMethod--string--tag--true","isColumn":true,"isJSON":false,"key":"httpMethod","type":"tag"},{"dataType":"string","id":"responseStatusCode--string--tag--true","isColumn":true,"isJSON":false,"key":"responseStatusCode","type":"tag"}],"softMax":0,"softMin":0,"stackedBarChart":false,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Pod phase by namespace","yAxisUnit":"none"},{"bucketCount":30,"bucketWidth":0,"columnUnits":{},"description":"","fillSpans":false,"id":"e87e271c-727b-4ae1-8d11-609a1ffaa31d","isStacked":false,"mergeAllActiveQueries":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"table","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"float64","id":"k8s_statefulset_current_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_statefulset_current_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[{"id":"f38b0603","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"40252381","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_statefulset_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_statefulset_name","type":"tag"}],"having":[],"legend":"current","limit":null,"orderBy":[],"queryName":"A","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_statefulset_desired_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_statefulset_desired_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"B","filters":{"items":[{"id":"9eb4877f","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"d2b21bc2","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_statefulset_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_statefulset_name","type":"tag"}],"having":[],"legend":"desired","limit":null,"orderBy":[],"queryName":"B","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_statefulset_ready_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_statefulset_ready_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"C","filters":{"items":[{"id":"85f90076","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"673b2d47","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_statefulset_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_statefulset_name","type":"tag"}],"having":[],"legend":"ready","limit":null,"orderBy":[],"queryName":"C","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"},{"aggregateAttribute":{"dataType":"float64","id":"k8s_statefulset_updated_pods--float64--Gauge--true","isColumn":true,"isJSON":false,"key":"k8s_statefulset_updated_pods","type":"Gauge"},"aggregateOperator":"max","dataSource":"metrics","disabled":false,"expression":"D","filters":{"items":[{"id":"7771ade4","key":{"dataType":"string","id":"k8s_namespace_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_namespace_name","type":"tag"},"op":"in","value":["$k8s_namespace_name"]},{"id":"b72d74da","key":{"dataType":"string","id":"k8s_cluster_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_cluster_name","type":"tag"},"op":"in","value":["$k8s_cluster_name"]}],"op":"AND"},"functions":[],"groupBy":[{"dataType":"string","id":"k8s_statefulset_name--string--tag--false","isColumn":false,"isJSON":false,"key":"k8s_statefulset_name","type":"tag"}],"having":[],"legend":"updated","limit":null,"orderBy":[],"queryName":"D","reduceTo":"last","spaceAggregation":"sum","stepInterval":60,"timeAggregation":"max"}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"a9f9f029-fc9e-4c68-8225-ce1dea1dc83d","promql":[{"disabled":false,"legend":"","name":"A","query":""}],"queryType":"builder"},"selectedLogFields":[{"dataType":"string","name":"body","type":""},{"dataType":"string","name":"timestamp","type":""}],"selectedTracesFields":[{"dataType":"string","id":"serviceName--string--tag--true","isColumn":true,"isJSON":false,"key":"serviceName","type":"tag"},{"dataType":"string","id":"name--string--tag--true","isColumn":true,"isJSON":false,"key":"name","type":"tag"},{"dataType":"float64","id":"durationNano--float64--tag--true","isColumn":true,"isJSON":false,"key":"durationNano","type":"tag"},{"dataType":"string","id":"httpMethod--string--tag--true","isColumn":true,"isJSON":false,"key":"httpMethod","type":"tag"},{"dataType":"string","id":"responseStatusCode--string--tag--true","isColumn":true,"isJSON":false,"key":"responseStatusCode","type":"tag"}],"softMax":0,"softMin":0,"stackedBarChart":false,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Statefulset pods","yAxisUnit":"none"}]}